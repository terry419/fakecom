# **jjabCOM 1ë‹¨ê³„ ë¦¬íŒ©í† ë§ ê³„íš**
## **Global / Session / Scene ë§¤ë‹ˆì € ì•„í‚¤í…ì²˜ ê°œí¸**

---

## **ğŸ“Š í˜„ì¬ ìƒíƒœ ë¶„ì„**

### **í˜„ì¬ì˜ ë¬¸ì œì **

#### 1. **ServiceLocator ì„¤ê³„ ë¬¸ì œ**
```
í˜„ì¬ ìƒíƒœ:
- ë‹¨ìˆœ Dictionary ê¸°ë°˜ (íƒ€ì… ì•ˆì „ì„± ë‚®ìŒ)
- Generic Get<T>()ë§Œ ì§€ì› (ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ì ‘ê·¼ ë¶ˆê°€)
- Scope ê°œë… ì—†ìŒ (Global/Session ì„ì—¬ ìˆìŒ)
- ì—ëŸ¬ ì²˜ë¦¬ê°€ ë¯¸í¡í•¨ (Debug.LogError ë§Œ í•¨)

ë¬¸ì œ ë°œìƒ ì¼€ì´ìŠ¤:
- SessionManager ì¢…ë£Œ ì‹œ Session ë§¤ë‹ˆì €ë“¤ì€ ì‚­ì œë˜ì–´ì•¼ í•˜ëŠ”ë°, 
  ServiceLocatorì—ì„œ Global ë§¤ë‹ˆì €ì™€ êµ¬ë¶„ ë¶ˆê°€
- ìƒˆ ì”¬ ì§„ì… ì‹œ ì´ì „ ì”¬ì˜ Session ë§¤ë‹ˆì €ê°€ ë‚¨ì•„ìˆì„ ìˆ˜ ìˆìŒ
```

#### 2. **IInitializable ì„¤ê³„ ë¬¸ì œ**
```
í˜„ì¬:
- void Initialize() ë°˜í™˜ (ë™ê¸°ì‹)

ë¬¸ì œ:
- UniTask ê¸°ë°˜ ë¹„ë™ê¸° ì´ˆê¸°í™” ë¶ˆê°€ëŠ¥
- ì´ˆê¸°í™” ìˆœì„œ ì œì–´ ë¶ˆê°€ëŠ¥
- ì‹¤íŒ¨ ì²˜ë¦¬ ë¯¸í¡
```

#### 3. **AppInitializerì˜ ë¬¸ì œ**
```
í˜„ì¬:
- static voidë¡œë§Œ ì‘ë™ (ìƒíƒœ ê´€ë¦¬ ë¶ˆê°€)
- WaitForCompletion() ì‚¬ìš© (ë©”ì¸ ìŠ¤ë ˆë“œ ë¸”ë¡œí‚¹)
- ì˜ˆì™¸ ì²˜ë¦¬ë§Œ í•˜ê³  ë³µêµ¬ ë¶ˆê°€ëŠ¥
- AppConfig ë¡œë“œ ë°©ì‹ ë³€ê²½
   - (í•´ê²°ë¨) Inspector ì—°ê²° ëŒ€ì‹  Addressables Label("AppConfig")ì„ ì‚¬ìš©í•˜ì—¬ ë™ì  ë¡œë“œ.
   - ì´ë¥¼ í†µí•´ BootScene ì—†ì´ë„ ì½”ë“œìƒì—ì„œ Configì— ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ê°œì„ .
ë¬¸ì œ:
- ê°œë°œ ì¤‘ ì¼ë°˜ ì”¬ì—ì„œ ì‹œì‘í•  ë•Œ Global í™˜ê²½ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŒ
- ë¶€íŒ… ì‹¤íŒ¨ ì‹œ ë³µêµ¬ ë°©ì•ˆ ì—†ìŒ
```

#### 4. **SceneInitializerì˜ ë¬¸ì œ**
```
í˜„ì¬:
- RegisterOrSpawn ì œë„¤ë¦­ë§Œ ì‚¬ìš© (ë™ì  ë§¤ë‹ˆì € ìƒì„± ë¶ˆê°€)
- Initialize()ëŠ” ë™ê¸°ì‹ì´ë¼ ìˆœì„œ ì œì–´ ë¯¸í¡
- ì—ëŸ¬ ë°œìƒ ì‹œ ì´ë¯¸ ë“±ë¡ëœ ë§¤ë‹ˆì € ì •ë¦¬ ë¶ˆê°€ëŠ¥

ë¬¸ì œ:
- ë§¤ë‹ˆì € ì´ˆê¸°í™” ì¤‘ í•˜ë‚˜ ì‹¤íŒ¨í•˜ë©´ partial state ë°œìƒ ê°€ëŠ¥
- ì”¬ ë¡œë“œ ì¤‘ì— Global ë§¤ë‹ˆì € í•„ìš”í•œ ê²½ìš° ì²˜ë¦¬ ë¶ˆê°€
```

#### 5. **Global/Session ê²½ê³„ê°€ ëª…í™•í•˜ì§€ ì•ŠìŒ**
```
í˜„ì¬:
- GameManager: Global (IInitializable êµ¬í˜„ ì—†ìŒ)
- InputManager: Global (IInitializable êµ¬í˜„ ì—†ìŒ)
- DataManager: Global (IInitializable êµ¬í˜„ ì—†ìŒ)
- SessionManager: Session (IInitializable êµ¬í˜„í•¨)

ë¬¸ì œ:
- Global ë§¤ë‹ˆì €ë“¤ì´ ìê°€ ë“±ë¡(Awakeì—ì„œ)í•˜ê³ ,
  Session ë§¤ë‹ˆì €ëŠ” SceneInitializerê°€ ë“±ë¡
- ì¼ê´€ì„± ì—†ìŒ
```

---

## **ğŸ¯ ë¦¬íŒ©í† ë§ ëª©í‘œ**

```
1. âœ… ServiceLocatorì— Scope ê°œë… ì¶”ê°€
   â†’ Global/Session ë§¤ë‹ˆì €ë¥¼ ëª…í™•íˆ ë¶„ë¦¬

2. âœ… IInitializableì„ UniTask ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½
   â†’ ë¹„ë™ê¸° ì´ˆê¸°í™” ì§€ì›, ìˆœì„œ ì œì–´

3. âœ… AppInitializerë¥¼ ì¸ìŠ¤í„´ìŠ¤ ê¸°ë°˜ìœ¼ë¡œ ê°œì„ 
   â†’ ë¶€íŒ… ìƒíƒœ ì¶”ì , ì¬ì‹œë„ ë¡œì§ ì¶”ê°€

4. âœ… SceneInitializer ì´ˆê¸°í™” ë¡œì§ ê°•í™”
   â†’ ì‹¤íŒ¨ ì‹œ ë¡¤ë°±, ë¦¬ì†ŒìŠ¤ ì •ë¦¬

5. âœ… Global/Session ë§¤ë‹ˆì €ì˜ ì¼ê´€ëœ ë“±ë¡ ë°©ì‹
   â†’ ëª¨ë‘ Initializerê°€ ê´€ë¦¬
```

---

## **ğŸ”§ Phase 1: ServiceLocator ë¦¬íŒ©í† ë§**

### **1.1 í˜„ì¬ ì½”ë“œì˜ ë¬¸ì œ**
```csharp
// âŒ í˜„ì¬ (ë¬¸ì œì )
public static class ServiceLocator
{
    private static readonly Dictionary<Type, object> _services 
        = new Dictionary<Type, object>();
    
    public static void Register<T>(T service)
    {
        // Scope êµ¬ë¶„ ì—†ìŒ â†’ Global/Sessionì´ ì„ì„
        // ì¤‘ë³µ ë“±ë¡ ì‹œ ê²½ê³ ë§Œ í•¨
    }
}
```

### **1.2 ë¦¬íŒ©í† ë§ ê³„íš**

#### **Step 1: ManagerScope + Scopeë³„ ì €ì¥ì†Œ ì¶”ê°€**
```
ServiceLocator ë‚´ë¶€ êµ¬ì¡°:

_globalServices: Dictionary<Type, object>
  â”œâ”€ GlobalSettingsSO
  â”œâ”€ GameManager
  â”œâ”€ InputManager
  â”œâ”€ DataManager
  â””â”€ ...

_sessionServices: Dictionary<Type, object>
  â”œâ”€ SessionManager
  â”œâ”€ TurnManager
  â”œâ”€ MapManager
  â””â”€ ...

_sceneServices: Dictionary<Type, object>
  â”œâ”€ CombatManager
  â”œâ”€ CameraController
  â””â”€ ...

[ë©”ì»¤ë‹ˆì¦˜]
- Register<T>(service, scope)ë¡œ ë“±ë¡
  â†’ í•´ë‹¹ scopeì˜ Dictionaryì—ë§Œ ì €ì¥
  
- Get<T>()
  â†’ _sceneServices â†’ _sessionServices â†’ _globalServices
  â†’ ìš°ì„ ìˆœìœ„ ìˆœìœ¼ë¡œ ê²€ìƒ‰

- ClearScope(scope)
  â†’ í•´ë‹¹ scopeì˜ ëª¨ë“  ì„œë¹„ìŠ¤ ì œê±°
  â†’ ì”¬ ì „í™˜ ì‹œ Session/Scene ì„œë¹„ìŠ¤ ì •ë¦¬
```

#### **Step 2: êµ¬ì²´ì ì¸ ë³€ê²½ ì‚¬í•­**

```
ê°œì„ ëœ ServiceLocatorì˜ ì£¼ìš” ë©”ì„œë“œ:

1. Register<T>(T service, ManagerScope scope)
   - scopeë³„ Dictionaryì— ì €ì¥
   - ì¤‘ë³µ ë“±ë¡ ì‹œ Exception ë°œìƒ (ê²½ê³  ì•„ë‹˜)

2. Get<T>()
   - ìš°ì„ ìˆœìœ„ ìˆœì„œë¡œ ê²€ìƒ‰ (Scene â†’ Session â†’ Global)
   - ì°¾ì§€ ëª»í•˜ë©´ null ë°˜í™˜ (ë¡œê·¸ë§Œ í•¨)

3. Unregister<T>(ManagerScope scope)
   - íŠ¹ì • scopeì—ì„œë§Œ ì œê±°

4. ClearScope(ManagerScope scope)
   - í•´ë‹¹ scopeì˜ ëª¨ë“  ì„œë¹„ìŠ¤ ì‚­ì œ
   - [ì¤‘ìš”] ì”¬ ì „í™˜ ì‹œ í˜¸ì¶œ

5. IsRegistered<T>()
   - ëª¨ë“  scopeì—ì„œ ê²€ìƒ‰

6. GetByInterface<TInterface>() where TInterface : class
   - [ì‹ ê·œ] ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ ì ‘ê·¼ ê°€ëŠ¥
   - ì˜ˆ: var managers = GetByInterface<IInitializable>()
   - â†’ Scene ë§¤ë‹ˆì €ë“¤ì˜ ì´ˆê¸°í™” ìˆœì„œ ì œì–´í•  ë•Œ ì‚¬ìš©

7. Reset ë¡œì§ ê°•í™”
   - ClearScope í˜¸ì¶œ ì‹œ, ë“±ë¡ëœ ì„œë¹„ìŠ¤ë“¤ì„ ì—­ìˆœìœ¼ë¡œ ìˆœíšŒí•˜ë©°
     ICleanup ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í–ˆëŠ”ì§€ í™•ì¸í•˜ê³  Cleanup()ì„ í˜¸ì¶œ.
```

#### **Step 3: ì‚¬ìš© ë°©ì‹ ë³€ê²½**

```csharp
// âœ… ë³€ê²½ í›„ (ì‚¬ìš© ë°©ì‹)

// [Global ë§¤ë‹ˆì € ìê°€ ë“±ë¡] - ë§¤ë‹ˆì € ë‚´ë¶€ Awake()ì—ì„œ ì‹¤í–‰
// GameManager.cs
private void Awake()
{
    ServiceLocator.Register(this, ManagerScope.Global);
}

// [Scene ë§¤ë‹ˆì € ì¤‘ì•™ ë“±ë¡] - SceneInitializerê°€ ìˆ˜í–‰
ServiceLocator.Register(combatManager, ManagerScope.Scene);

// [ì¡°íšŒ]
var gameManager = ServiceLocator.Get<GameManager>();
// â†’ _globalServicesì—ì„œ ì°¾ìŒ

var combatManager = ServiceLocator.Get<CombatManager>();
// â†’ _sceneServicesì—ì„œ ì°¾ìŒ (ë§Œì•½ ì—†ë‹¤ë©´ _sessionServices â†’ _globalServices ìˆœìœ¼ë¡œ ê²€ìƒ‰)

// [ì”¬ ì „í™˜ ì‹œ ì •ë¦¬]
ServiceLocator.ClearScope(ManagerScope.Session);
ServiceLocator.ClearScope(ManagerScope.Scene);
```

---

## **ğŸ”§ Phase 2: IInitializable ë¦¬íŒ©í† ë§**

### **2.1 í˜„ì¬ ì½”ë“œì˜ ë¬¸ì œ**
```csharp
// âŒ í˜„ì¬ (ë™ê¸°ì‹, ë¹„ë™ê¸° ë¯¸ì§€ì›)
public interface IInitializable
{
    void Initialize();
}

// â†’ ì´ˆê¸°í™” ìˆœì„œ ì œì–´ ë¶ˆê°€ëŠ¥
```

### 2.2 ë¦¬íŒ©í† ë§ ê³„íš

#### **Step 1: ì¸í„°í˜ì´ìŠ¤ ë° ì»¨í…ìŠ¤íŠ¸ í´ë˜ìŠ¤ ê°œí¸**

*   `IInitializable` ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì„œë“œë¥¼ `UniTask` ê¸°ë°˜ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•˜ê³ , í•˜ì´ë¸Œë¦¬ë“œ ì •ë¦¬ ë°©ì‹ ë° `ISaveData`ë¥¼ ë°˜ì˜í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ ì¸í„°í˜ì´ìŠ¤ì™€ í´ë˜ìŠ¤ë¥¼ ìƒˆë¡œ ì •ì˜í•œë‹¤.

```csharp
// âœ… ë³€ê²½ í›„: ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ (í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹)
public interface IInitializable
{
    UniTask Initialize(InitializationContext context);
}

public interface ICleanup // [ì‹ ê·œ] ì„ íƒì  êµ¬í˜„
{
    void Cleanup();
}

// [ì‹ ê·œ] ì„¸ì´ë¸Œ ë°ì´í„° ì¶”ìƒí™” ì¸í„°í˜ì´ìŠ¤
public interface ISaveData
{
    // ì´ˆê¸°í™”ì— í•„ìš”í•œ ìµœì†Œí•œì˜ ë°ì´í„°ë§Œ ì •ì˜
    // ì˜ˆ: string PlayerName { get; }
}

// âœ… ë³€ê²½ í›„: InitializationContext í´ë˜ìŠ¤
public class InitializationContext
{
    public GlobalSettingsSO GlobalSettings { get; set; }
    public ManagerScope Scope { get; set; }
    public MapDataSO? MapData { get; set; } = null;

    // [ë³€ê²½] object -> ISaveData? (íƒ€ì… ì•ˆì „ì„± í™•ë³´ ë° ëŠìŠ¨í•œ ê²°í•©)
    public ISaveData? UserData { get; set; } = null; 

    public bool HasMapData => MapData != null;
}
```

#### **Step 2: ì´ˆê¸°í™” ìˆœì„œ ì œì–´**

```
í•µì‹¬ ì•„ì´ë””ì–´:
â†’ SceneInitializerê°€ ë§¤ë‹ˆì €ë“¤ì„ "ë“±ë¡"í•œ í›„,
â†’ "ì´ˆê¸°í™”"í•  ë§¤ë‹ˆì €ë“¤ì„ ëª…ì‹œì  ìˆœì„œë¡œ ì„ íƒ
â†’ UniTask.WhenAllë¡œ ë³‘ë ¬/ì§ë ¬ ì´ˆê¸°í™” ì œì–´

[ì˜ˆì‹œ] SceneInitializerì˜ ì´ˆê¸°í™” ìˆœì„œ:

1ë‹¨ê³„: System ë ˆì´ì–´ (ìˆœì°¨)
   MapManager.Initialize(context)
   â†“ (ì™„ë£Œ í›„)
   TurnManager.Initialize(context)

2ë‹¨ê³„: Combat ë ˆì´ì–´ (ë³‘ë ¬)
   Task A: CombatManager.Initialize(context)
   Task B: CameraController.Initialize(context)
   â†“ (ë‘˜ ë‹¤ ì™„ë£Œ í›„)

3ë‹¨ê³„: UI ë ˆì´ì–´ (ë³‘ë ¬)
   Task A: TargetUIManager.Initialize(context)
   Task B: DamageTextManager.Initialize(context)
   ...
```

---

## **ğŸ”§ Phase 3: AppInitializer ë¦¬íŒ©í† ë§**

### **3.1 í˜„ì¬ ì½”ë“œì˜ ë¬¸ì œ**
```
1. static class â†’ ìƒíƒœ ì¶”ì  ë¶ˆê°€ëŠ¥
2. WaitForCompletion() â†’ ë©”ì¸ ìŠ¤ë ˆë“œ ë¸”ë¡œí‚¹
3. ë¶€íŒ… ì‹¤íŒ¨ ì‹œ ë³µêµ¬ ë°©ì•ˆ ì—†ìŒ
4. AppConfig ì°¸ì¡°ê°€ ìˆ˜ë™ìœ¼ë¡œ ì„¤ì •ë¨
```

### 3.2 ë¦¬íŒ©í† ë§ ê³„íš

#### **[ì„ í–‰ ì‘ì—…] ResourceKeys ì •ì˜**
- í•˜ë“œì½”ë”© ë°©ì§€ë¥¼ ìœ„í•´ ì •ì  ìƒìˆ˜ í´ë˜ìŠ¤ ë„ì…
```csharp
public static class ResourceKeys
{
    public const string AppConfig = "AppConfig"; // ì§„ì…ì  í‚¤
}
```

#### **Step 0: AppConfig í•„ë“œ ì •ì˜**
*   **AppConfig (ScriptableObject)** ì— ë‹¤ìŒ í•„ë“œë“¤ì„ ì¶”ê°€í•˜ì—¬ ë¶€íŒ…ì— í•„ìš”í•œ í•µì‹¬ ë¦¬ì†ŒìŠ¤ ì°¸ì¡°ë¥¼ ë°ì´í„°í™”í•œë‹¤.

```csharp
// AppConfig.cs
[CreateAssetMenu(fileName = "AppConfig", menuName = "System/AppConfig")]
public class AppConfig : ScriptableObject
{
    [Header("Core References")]
    public AssetReferenceGameObject BootCanvasRef; // ë¶€íŒ… ì‹œ í‘œì‹œí•  ë¡œë”© UI
    public AssetReferenceT<ResLibrarySO> ResLibraryRef; // Bì•ˆ ë°©ì‹ì˜ ë¦¬ì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬
    
    [Header("Global Managers")]
    public AssetReferenceGameObject GameManagerRef;
    public AssetReferenceGameObject DataManagerRef;
    public AssetReferenceGameObject InputManagerRef;
    public AssetReferenceGameObject SaveManagerRef;
    // ...
}
```

#### **Step 1: êµ¬ì¡° ë³€ê²½**

```
âŒ í˜„ì¬:
[RuntimeInitializeOnLoadMethod] static void InitializeGame()
{
    WaitForCompletion() // ë¸”ë¡œí‚¹!
}

âœ… ë³€ê²½ í›„:
public class AppInitializer : MonoBehaviour
{
    public event Action<BootState> OnBootStateChanged;
    public BootState CurrentBootState { get; private set; }
    
    private List<IInitializable> _globalManagers;
    private AppConfig _config;
    
    // [RuntimeInitializeOnLoadMethod]ë¡œ ìì‹ ì„ ìƒì„±
    // â†’ ì´í›„ ë¹„ë™ê¸°ë¡œ ë¶€íŒ… ì§„í–‰
}

public enum BootState
{
    Uninitialized,
    LoadingAddressables,
    LoadingAppConfig,
    RegisteringGlobalServices,
    Complete,
    Failed
}
```

#### **Step 2: ë¶€íŒ… íë¦„ ê°œì„ **

```
[ë¶€íŒ… ì‹œë‚˜ë¦¬ì˜¤]

1. [RuntimeInitializeOnLoadMethod] í˜¸ì¶œ
   â†“ (AppInitializer ì¸ìŠ¤í„´ìŠ¤ ìƒì„±)

2. InitializeAsync() í˜¸ì¶œ (ë¹„ë™ê¸°)
   â†“
2-1. [ì‹ ê·œ] BootCanvas ë¡œë”© UI í‘œì‹œ
     - í”„ë¦¬íŒ¹ ìƒì„± ë° DontDestroyOnLoad ì„¤ì •
   â†“
3-1. Step 1: Addressables ì´ˆê¸°í™”
     if (ì‹¤íŒ¨) â†’ BootState = Failed â†’ ì¢…ë£Œ

3-2. Step 2: AppConfig ë¡œë“œ
     - [ë³€ê²½] "AppConfig" ë¬¸ìì—´ ëŒ€ì‹  ResourceKeys.AppConfig ì‚¬ìš©
     if (ì‹¤íŒ¨) â†’ BootState = Failed â†’ ì¢…ë£Œ

3-3. Step 3: Global ë§¤ë‹ˆì € ìƒì„± (Instantiate Only)
     - Addressablesì—ì„œ "Manager" ë¼ë²¨ì´ ë¶™ì€ í”„ë¦¬íŒ¹ ë¡œë“œ
     - Instantiate(prefab) í˜¸ì¶œ 
     - (ì´ ì‹œì ì— í”„ë¦¬íŒ¹ì˜ Awakeê°€ ëŒë©´ì„œ ServiceLocatorì— **ìê°€ ë“±ë¡ë¨**)

3-4. Step 4: Global ë§¤ë‹ˆì € ì´ˆê¸°í™” (Injection)
     - ServiceLocator.Get<GameManager>()ë¡œ ë“±ë¡ëœ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ì ¸ì˜´
     - gameManager.Initialize(context) í˜¸ì¶œ

4. [ì‹ ê·œ] BootCanvas ì œê±° ë° OnBootStateChanged?.Invoke(BootState.Complete)

```

#### **Step 3: ê°œë°œ í¸ì˜ì„± ê°œì„  (Auto-Bootstrap)**

*   **ë¬¸ì œì :** `BootScene`ì´ ì•„ë‹Œ ì „íˆ¬ ì”¬(Level1 ë“±)ì—ì„œ ë°”ë¡œ Play ë²„íŠ¼ì„ ëˆŒëŸ¬ í…ŒìŠ¤íŠ¸í•  ë•Œ, Global ë§¤ë‹ˆì €ë“¤ì´ ì—†ì–´ Null ì°¸ì¡° ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.
*   **í•´ê²°ì±…:** `SceneInitializer`ê°€ `Awake()` ì‹œì ì— Global ë§¤ë‹ˆì €ì˜ ì¡´ì¬ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³ , ì—†ì„ ê²½ìš° `AppInitializer`ë¥¼ ê°•ì œë¡œ ì‹¤í–‰í•˜ì—¬ Global í™˜ê²½ì„ ë¨¼ì € êµ¬ì¶•(Bootstrap)í•˜ë„ë¡ í•œë‹¤.

```csharp
// SceneInitializer.cs
public class SceneInitializer : MonoBehaviour
{
    private async void Awake()
    {
        // [ì²´í¬] Global ë§¤ë‹ˆì €ê°€ ì¤€ë¹„ë˜ì—ˆëŠ”ê°€?
        if (!ServiceLocator.IsRegistered<GameManager>())
        {
            // â†’ AppInitializerë¥¼ ì°¾ì•„ ê°•ì œ ë¶€íŒ… ì‹¤í–‰
            await BootGlobalManagersAsync();
        }
        
        // Global í™˜ê²½ì´ ì¤€ë¹„ëœ í›„, Scene ì´ˆê¸°í™” ì§„í–‰
        InitializeScene();
    }
    
    private async UniTask BootGlobalManagersAsync()
    {
        // AppInitializerëŠ” DontDestroyOnLoadì´ë¯€ë¡œ FindObjectOfTypeìœ¼ë¡œ ì°¾ì„ ìˆ˜ ìˆìŒ
        var appInitializer = FindObjectOfType<AppInitializer>();
        if (appInitializer != null)
        {
            // AppInitializerì˜ ë¹„ë™ê¸° ë¶€íŒ…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°
            await appInitializer.InitializeAsync();
        }
        else
        {
            Debug.LogError("AppInitializerê°€ ì”¬ì— ì¡´ì¬í•˜ì§€ ì•Šì•„ ë¶€íŠ¸ìŠ¤íŠ¸ë©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
    }

    private void InitializeScene()
    {
        // ... ê¸°ì¡´ Scene ë§¤ë‹ˆì € ë“±ë¡ ë° ì´ˆê¸°í™” ë¡œì§ ...
    }
}
```

---

## **ğŸ”§ Phase 4: SceneInitializer ë¦¬íŒ©í† ë§**

### **4.1 í˜„ì¬ ì½”ë“œì˜ ë¬¸ì œ**
```
1. ë§¤ë‹ˆì € ì´ˆê¸°í™” ì¤‘ ì‹¤íŒ¨í•˜ë©´ partial state ë°œìƒ
2. ë¡¤ë°± ë©”ì»¤ë‹ˆì¦˜ ì—†ìŒ
3. Session/Scene ë§¤ë‹ˆì €ê°€ ì„ì—¬ ìˆìŒ
4. ë¦¬ì†ŒìŠ¤ ì •ë¦¬ê°€ ë¯¸í¡í•¨
```

### **4.2 ë¦¬íŒ©í† ë§ ê³„íš**

#### **Step 1: ê³„ì¸µ ë¶„ë¦¬**

```
í˜„ì¬:
- All managers in one Awake() â†’ RegisterOrSpawn

ë³€ê²½ í›„:
- Layer 1: System (MapManager, TurnManager)
- Layer 2: Combat (CombatManager, ...)
- Layer 3: Visual (CameraController, TargetUIManager, ...)
- Layer 4: Tool (TilemapGenerator, ...)

ê° LayerëŠ”:
1) ìˆœì„œëŒ€ë¡œ Spawn
2) Initialize ìˆœì„œ ëª…ì‹œì ìœ¼ë¡œ ì œì–´
```

#### **Step 2: ì´ˆê¸°í™” ì‹¤íŒ¨ ì²˜ë¦¬**

```csharp
// ë³€ê²½ í›„: Initialize ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨ ì²˜ë¦¬

private async UniTask InitializeAllManagers()
{
    var context = new InitializationContext { ... };
    
    try
    {
        // Layer 1: System (ìˆœì°¨)
        await MapManager.Initialize(context);
        await TurnManager.Initialize(context);
        
        // Layer 2: Combat (ë³‘ë ¬)
        await UniTask.WhenAll(
            CombatManager.Initialize(context),
            ...
        );
        
        // Layer 3: Visual (ë³‘ë ¬)
        await UniTask.WhenAll(
            CameraController.Initialize(context),
            TargetUIManager.Initialize(context),
            ...
        );
    }
    catch (Exception ex)
    {
        // âŒ ì‹¤íŒ¨ ì‹œ ë¡¤ë°± (í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹ ì ìš©)
        // _managers ë¦¬ìŠ¤íŠ¸ë¥¼ ì—­ìˆœìœ¼ë¡œ ìˆœíšŒí•˜ë©°
        // if (manager is ICleanup cleanupTarget) cleanupTarget.Cleanup();
        await RollbackInitialization();
        SessionManager.ChangeState(SessionState.Error);
    }
}
```

#### **Step 3: ì”¬ ì „í™˜ ì‹œ ì •ë¦¬**

```csharp
// OnDestroyì—ì„œ ì²´ê³„ì ì¸ ì •ë¦¬

private void OnDestroy()
{
    // 1. Session ë§¤ë‹ˆì € ì •ë¦¬
    ServiceLocator.ClearScope(ManagerScope.Session);
    
    // 2. Scene ë§¤ë‹ˆì € ì •ë¦¬
    ServiceLocator.ClearScope(ManagerScope.Scene);
    
    // 3. ë¦¬ì†ŒìŠ¤ ì •ë¦¬
    UnloadSceneResources();
}
```

---

## **ğŸ”§ Phase 5: Global/Session/Scene ë§¤ë‹ˆì € ë¶„ë¥˜**

### **5.1 Global (ì•± ì‹¤í–‰ ~ ì¢…ë£Œ)**

```
ë§¤ë‹ˆì € ëª©ë¡:
1. GlobalSettingsSO
   - Scope: Global
   - ì´ˆê¸°í™”: AppInitializerê°€ ë¡œë“œ

2. GameManager
   - Scope: Global
   - ì—­í• : ìµœìƒìœ„ ê²Œì„ ìƒíƒœ (Menu, InGame)
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜
   
3. InputManager
   - Scope: Global
   - ì—­í• : ì…ë ¥ ë ˆì´ì–´ (UI/Game ì „í™˜)
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

4. DataManager
   - Scope: Global
   - ì—­í• : SO ìºì‹±, ì„¸ì´ë¸Œ ë°ì´í„°
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

5. SaveManager [ì‹ ê·œ]
   - Scope: Global
   - ì—­í• : íŒŒì¼ I/O ë‹´ë‹¹. ì´ˆê¸°í™” ì‹œì ì— ISaveData êµ¬í˜„ì²´(ì˜ˆ: SaveProfile)ë¥¼ ìƒì„±í•˜ì—¬ InitializationContextì— ì œê³µ.
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜
```

### **5.2 Session (ì „íˆ¬ ì”¬ ë¡œë“œ ~ ì–¸ë¡œë“œ)**

```
ë§¤ë‹ˆì € ëª©ë¡:
1. SessionManager
   - Scope: Session
   - ì—­í• : ì „íˆ¬ FSM (Boot â†’ Setup â†’ TurnWaiting â†’ ...)
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

2. TurnManager
   - Scope: Session
   - ì—­í• : TS ê³„ì‚°, í„´ í ê´€ë¦¬
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

3. MapManager
   - Scope: Session
   - ì—­í• : ë§µ ìƒì„±, NavMesh, ì—„íë¬¼ ë°ì´í„°
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜
```

### **5.3 Scene (í˜„ì¬ ì”¬ ë¡œë“œ ~ ì–¸ë¡œë“œ)**

```
ë§¤ë‹ˆì € ëª©ë¡:
1. CombatManager
   - Scope: Scene
   - ì—­í• : ëª…ì¤‘ë¥ /ë°ë¯¸ì§€ ê³µì‹, ê³µê²©/í”¼ê²© íŒì •
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

2. PlayerInputCoordinator
   - Scope: Scene
   - ì—­í• : í”Œë ˆì´ì–´ ì…ë ¥ â†’ Unit ëª…ë ¹ ë³€í™˜
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

3. CameraController
   - Scope: Scene
   - ì—­í• : ì‹œì  ì œì–´, ì•¡ì…˜ ìº  ì—°ì¶œ
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

4. TargetUIManager
   - Scope: Scene
   - ì—­í• : íƒ€ê²Ÿ UI (HPë°”, ëª…ì¤‘ë¥ ) í’€ë§
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

5. DamageTextManager
   - Scope: Scene
   - ì—­í• : ë°ë¯¸ì§€ í”Œë¡œíŒ… í…ìŠ¤íŠ¸
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

6. QTEManager
   - Scope: Scene
   - ì—­í• : QTE ë¯¸ë‹ˆê²Œì„ ë¡œì§ & UI
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

7. PathVisualizer
   - Scope: Scene
   - ì—­í• : ì´ë™ ê²½ë¡œ ì‹œê°í™”
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜

8. TilemapGenerator
   - Scope: Scene
   - ì—­í• : ë§µ ëª¨ë“ˆì‹ ê±´ì¶•
   - ì´ˆê¸°í™”: IInitializable êµ¬í˜„ í•„ìˆ˜
```

---

## **ğŸ“‹ ë¦¬íŒ©í† ë§ ì²´í¬ë¦¬ìŠ¤íŠ¸**

### **ë‹¨ê³„ë³„ êµ¬í˜„ ìˆœì„œ**

#### **Phase 1-1: ServiceLocator ê°œì„ **
- [ ] ManagerScope ë¶„ë¦¬ ê¸°ëŠ¥ ì¶”ê°€
  - [ ] _globalServices Dictionary
  - [ ] _sessionServices Dictionary
  - [ ] _sceneServices Dictionary
  
- [ ] ë“±ë¡/ì¡°íšŒ ë©”ì„œë“œ ê°œì„ 
  - [ ] Register<T>(service, scope)
  - [ ] Unregister<T>(scope)
  - [ ] ClearScope(scope)
  - [ ] GetByInterface<TInterface>()
  
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ 
  - [ ] ì¤‘ë³µ ë“±ë¡ â†’ Exception
  - [ ] ë¯¸ë“±ë¡ ì¡°íšŒ â†’ null ë°˜í™˜

#### **Phase 1-2: IInitializable + IInitializationContext**
- [ ] IInitializable ì¸í„°í˜ì´ìŠ¤ ë³€ê²½
  - [ ] void Initialize() â†’ UniTask Initialize(context)
  
- [ ] IInitializationContext ì‹ ê·œ ì‘ì„±
  - [ ] ManagerScope CurrentScope
  - [ ] MapDataSO CurrentMapData
  - [ ] GlobalSettingsSO GlobalSettings
  
- [ ] InitializationContext êµ¬í˜„

#### **Phase 2-1: AppInitializer ì¸ìŠ¤í„´ìŠ¤í™”**
- [ ] static â†’ MonoBehaviourë¡œ ë³€ê²½
- [ ] BootState enum ì¶”ê°€
- [ ] OnBootStateChanged event ì¶”ê°€

#### **Phase 2-2: ë¶€íŒ… íë¦„ ë¹„ë™ê¸°í™”**
- [ ] InitializeAsync() ë©”ì„œë“œ ì‘ì„±
- [ ] Addressables ì´ˆê¸°í™” (await)
- [ ] AppConfig ë¡œë“œ (await)
- [ ] Global ë§¤ë‹ˆì € ìƒì„± (await)
- [ ] Global ë§¤ë‹ˆì € ì´ˆê¸°í™” (await UniTask.WhenAll)

#### **Phase 2-3: ê°œë°œ í¸ì˜ì„±**
- [ ] SceneInitializer â†’ AppInitializer ìë™ ë¶€íŒ… ì²´í¬
- [ ] WaitForBootComplete() ë©”ì„œë“œ

#### **Phase 3-1: SceneInitializer ê°œì„ **
- [ ] Layer ë¶„ë¥˜ (System â†’ Combat â†’ Visual â†’ Tool)
- [ ] ê° Layerì˜ ë§¤ë‹ˆì € ëª…ì‹œì  ìˆœì„œ ì œì–´
- [ ] InitializeAllManagers() ê°œì„  (ë³‘ë ¬/ìˆœì°¨ êµ¬ë¶„)

#### **Phase 3-2: ì‹¤íŒ¨ ì²˜ë¦¬ & ë¡¤ë°±**
- [ ] try-catch with RollbackInitialization()
- [ ] SessionManager.ChangeState(SessionState.Error)

#### **Phase 3-3: ì”¬ ì „í™˜ ì •ë¦¬**
- [ ] OnDestroy() ê°•í™”
- [ ] ClearScope(Session/Scene) í˜¸ì¶œ
- [ ] ë¦¬ì†ŒìŠ¤ ì •ë¦¬

#### **Phase 4: Global ë§¤ë‹ˆì € ì´ê´€**
- [ ] GameManager â†’ IInitializable êµ¬í˜„
- [ ] InputManager â†’ IInitializable êµ¬í˜„
- [ ] DataManager â†’ IInitializable êµ¬í˜„
- [ ] SaveManager [ì‹ ê·œ] ì‘ì„± + IInitializable

#### **Phase 5: Session ë§¤ë‹ˆì € í™•ì¸**
- [ ] SessionManager â†’ ManagerScope.Session
- [ ] TurnManager â†’ ManagerScope.Session
- [ ] MapManager â†’ ManagerScope.Session

#### **Phase 6: í†µí•© í…ŒìŠ¤íŠ¸**
- [ ] ê²Œì„ ì‹œì‘ â†’ Global ë¶€íŒ… í…ŒìŠ¤íŠ¸
- [ ] ì „íˆ¬ ì”¬ ì§„ì… â†’ Session ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
- [ ] ì”¬ ì „í™˜ â†’ ì •ë¦¬ í…ŒìŠ¤íŠ¸
- [ ] ì¤‘ê°„ ì”¬ì—ì„œ Play â†’ Bootstrap í…ŒìŠ¤íŠ¸

---

## **ğŸ¬ ê²°ê³¼ êµ¬ì¡°ë„**

```
[AppInitializer] (MonoBehaviour)
â”œâ”€ BootState
â”œâ”€ Event: OnBootStateChanged
â”œâ”€ InitializeAsync()
â””â”€ WaitForBootComplete()
   â”‚
   â”œâ”€â†’ ServiceLocator.Register<T>(service, Scope.Global)
   â”‚   â”œâ”€ GlobalSettingsSO
   â”‚   â”œâ”€ GameManager
   â”‚   â”œâ”€ InputManager
   â”‚   â”œâ”€ DataManager
   â”‚   â””â”€ SaveManager
   â”‚
   â””â”€â†’ OnBootComplete â†’ Ready for Scene

[SceneInitializer] (MonoBehaviour in Battle Scene)
â”œâ”€ Awake()
â”‚  â””â”€ Check Global Ready? (If not: BootGlobalAsync)
â”‚
â”œâ”€ RegisterOrSpawn<T>()
â”‚  â”œâ”€ Layer 1 (System): MapManager, TurnManager
â”‚  â”œâ”€ Layer 2 (Combat): CombatManager, ...
â”‚  â”œâ”€ Layer 3 (Visual): CameraController, TargetUIManager, ...
â”‚  â””â”€ Layer 4 (Tool): TilemapGenerator, ...
â”‚
â”œâ”€ InitializeAllManagers()
â”‚  â””â”€ Layerë³„ ìˆœì°¨/ë³‘ë ¬ await UniTask.Initialize()
â”‚
â”œâ”€ OnDestroy()
â”‚  â””â”€ ClearScope(Session/Scene)
â”‚
â””â”€â†’ ServiceLocator ìƒíƒœ
    â”œâ”€ Global: ìœ ì§€
    â”œâ”€ Session: ì œê±°ë¨ âœ“
    â””â”€ Scene: ì œê±°ë¨ âœ“

[ServiceLocator]
â”œâ”€ _globalServices (GameManager, InputManager, ...)
â”œâ”€ _sessionServices (SessionManager, TurnManager, MapManager)
â”œâ”€ _sceneServices (CombatManager, CameraController, ...)
â”‚
â”œâ”€ Register<T>(service, scope)
â”œâ”€ Get<T>() â†’ scope ìš°ì„ ìˆœìœ„ë¡œ ê²€ìƒ‰
â”œâ”€ Unregister<T>(scope)
â”œâ”€ ClearScope(scope)
â””â”€ GetByInterface<TInterface>()
```

---

## **âœ… ì´ ë¦¬íŒ©í† ë§ì˜ ì´ì **

1. **ëª…í™•í•œ ìƒëª…ì£¼ê¸° ê´€ë¦¬**
   - Global/Session/Sceneì´ ì™„ì „íˆ ë¶„ë¦¬ë¨
   - ì”¬ ì „í™˜ ì‹œ ìë™ ì •ë¦¬

2. **ë¹„ë™ê¸° ì´ˆê¸°í™”**
   - WaitForCompletion() ì œê±° â†’ ë¶€ë“œëŸ¬ìš´ ë¡œë”©
   - ì´ˆê¸°í™” ìˆœì„œ ëª…ì‹œì  ì œì–´

3. **ê°œë°œ í¸ì˜ì„±**
   - ì¤‘ê°„ ì”¬ì—ì„œ Play ì‹œ ìë™ Bootstrap
   - í…ŒìŠ¤íŠ¸ ìš©ì´

4. **ì•ˆì •ì„±**
   - ì‹¤íŒ¨ ì‹œ ë¡¤ë°± ê°€ëŠ¥
   - ë¶€íŒ… ìƒíƒœ ì¶”ì 

5. **í™•ì¥ì„±**
   - GetByInterfaceë¡œ ë™ì  ë§¤ë‹ˆì € ê·¸ë£¹í™” ê°€ëŠ¥
   - ìƒˆ Scope ì¶”ê°€ ìš©ì´

